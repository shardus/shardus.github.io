<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Private messaging | Developer Docs</title>
    <meta name="description" content="Shardus Documentation Developer Docs">
    <meta name="generator" content="VuePress 1.3.0">
    
    
    <link rel="preload" href="/assets/css/0.styles.5a5d7c89.css" as="style"><link rel="preload" href="/assets/js/app.00bf7fce.js" as="script"><link rel="preload" href="/assets/js/2.3fd0cf3c.js" as="script"><link rel="preload" href="/assets/js/20.395bbe02.js" as="script"><link rel="prefetch" href="/assets/js/10.c8f90647.js"><link rel="prefetch" href="/assets/js/11.94268391.js"><link rel="prefetch" href="/assets/js/12.72e03446.js"><link rel="prefetch" href="/assets/js/13.ef2570b2.js"><link rel="prefetch" href="/assets/js/14.90f948c7.js"><link rel="prefetch" href="/assets/js/15.d1ab9f27.js"><link rel="prefetch" href="/assets/js/16.c3c3afde.js"><link rel="prefetch" href="/assets/js/17.11d93fa5.js"><link rel="prefetch" href="/assets/js/18.805f0b18.js"><link rel="prefetch" href="/assets/js/19.64845a7b.js"><link rel="prefetch" href="/assets/js/21.060e90c4.js"><link rel="prefetch" href="/assets/js/22.69ee7234.js"><link rel="prefetch" href="/assets/js/23.730f4a89.js"><link rel="prefetch" href="/assets/js/24.e9661cf2.js"><link rel="prefetch" href="/assets/js/25.b88ed052.js"><link rel="prefetch" href="/assets/js/26.0a46c1b0.js"><link rel="prefetch" href="/assets/js/27.d1a5d31e.js"><link rel="prefetch" href="/assets/js/28.b03d88a5.js"><link rel="prefetch" href="/assets/js/29.926bb12f.js"><link rel="prefetch" href="/assets/js/3.d41181b0.js"><link rel="prefetch" href="/assets/js/30.c288473d.js"><link rel="prefetch" href="/assets/js/31.d4e4aa7d.js"><link rel="prefetch" href="/assets/js/32.b4459487.js"><link rel="prefetch" href="/assets/js/33.3a0ede7d.js"><link rel="prefetch" href="/assets/js/34.86c50212.js"><link rel="prefetch" href="/assets/js/35.89be3532.js"><link rel="prefetch" href="/assets/js/36.09e568d9.js"><link rel="prefetch" href="/assets/js/37.16092d15.js"><link rel="prefetch" href="/assets/js/38.b486685c.js"><link rel="prefetch" href="/assets/js/39.d5eba328.js"><link rel="prefetch" href="/assets/js/4.bdc95c51.js"><link rel="prefetch" href="/assets/js/40.f134f176.js"><link rel="prefetch" href="/assets/js/41.2edff556.js"><link rel="prefetch" href="/assets/js/42.49878b4e.js"><link rel="prefetch" href="/assets/js/43.d361b248.js"><link rel="prefetch" href="/assets/js/44.4e0cbe5a.js"><link rel="prefetch" href="/assets/js/45.97751687.js"><link rel="prefetch" href="/assets/js/46.567954e6.js"><link rel="prefetch" href="/assets/js/47.ac9ca5d5.js"><link rel="prefetch" href="/assets/js/48.e64957d7.js"><link rel="prefetch" href="/assets/js/49.1cdf48ac.js"><link rel="prefetch" href="/assets/js/5.70dbfd4e.js"><link rel="prefetch" href="/assets/js/50.a66c1e36.js"><link rel="prefetch" href="/assets/js/51.3b91b6e9.js"><link rel="prefetch" href="/assets/js/52.9176ffa0.js"><link rel="prefetch" href="/assets/js/53.e7bf447f.js"><link rel="prefetch" href="/assets/js/54.44e77f2a.js"><link rel="prefetch" href="/assets/js/55.be25ed52.js"><link rel="prefetch" href="/assets/js/56.2d408352.js"><link rel="prefetch" href="/assets/js/57.7741f961.js"><link rel="prefetch" href="/assets/js/58.b6af1112.js"><link rel="prefetch" href="/assets/js/6.e910ed1d.js"><link rel="prefetch" href="/assets/js/7.6d6a826f.js"><link rel="prefetch" href="/assets/js/8.a3f31b66.js"><link rel="prefetch" href="/assets/js/9.0a5314d4.js">
    <link rel="stylesheet" href="/assets/css/0.styles.5a5d7c89.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="Developer Docs" class="logo"> <span class="site-name can-hide">Developer Docs</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Installation</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Main Concepts</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/source/main-concepts/shardus-cli-tool/shardus-cli-tool.html" class="sidebar-heading clickable"><span>Shardus CLI Tools</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/source/main-concepts/application-fundamentals/application-fundamentals.html" class="sidebar-heading clickable"><span>Application Fundementals</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/source/main-concepts/building-a-poc-app/general.html" class="sidebar-heading clickable open"><span>Building a PoC App</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/source/main-concepts/building-a-poc-app/building-a-poc-app.html" class="sidebar-link">Building a PoC App</a></li><li><a href="/source/main-concepts/building-a-poc-app/building-a-reward-system.html" class="sidebar-link">Building a reward system</a></li><li><a href="/source/main-concepts/building-a-poc-app/private-messaging.html" class="active sidebar-link">Private messaging</a></li><li><a href="/source/main-concepts/building-a-poc-app/building-a-frontend/building-a-frontend.html" class="sidebar-link">Building a frontend</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/source/main-concepts/poc-to-production/poc-to-production.html" class="sidebar-heading clickable"><span>Poc To Production</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/source/main-concepts/spamming-the-network/spamming-the-network.html" class="sidebar-heading clickable"><span>Spamming The Network</span> <span class="arrow right"></span></a> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>SDK Reference</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/source/support-and-feedback/raise-an-issue-on-gitlab.html" class="sidebar-link">Support and Feedback</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="private-messaging"><a href="#private-messaging" class="header-anchor">#</a> Private Messaging</h1> <p>A decentralized chat application wouldn't very useful if anyone could read the chat history between two users. So here we will implement a feature to send &quot;private messages&quot; which can only be &quot;read&quot; or &quot;decrypted&quot; (in better terms) between the two users in the chat.</p> <blockquote><p>You could add cases for the &quot;private_message&quot; transaction in your server-side code, but for the sake of ease, we're only going to touch <strong>client.js</strong> because it's exactly the same as the &quot;message&quot; transaction&quot;. We really don't even need to add a new &quot;private_message&quot; transaction type to the server really, because all the encryption and decryption happens on the clients.</p></blockquote> <p>In <strong>client.js</strong> add a new CLI command to send &quot;private messages&quot;.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// The Required Modules</span>
<span class="token keyword">const</span> vorpal <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;vorpal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> got <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;got&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;shardus-crypto-utils&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">crypto</span><span class="token punctuation">(</span><span class="token string">&quot;64f152869ca2d473e4ba64ab53f49ccdb2edae22da192c126850970e788af347&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

vorpal
  <span class="token punctuation">.</span><span class="token function">command</span><span class="token punctuation">(</span>
    <span class="token string">&quot;private message send &lt;message&gt; &lt;source&gt; &lt;target&gt;&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;sends a private message from &lt;source&gt; to &lt;target&gt; that only &lt;target&gt; can decrypt&quot;</span>
  <span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">action</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">args<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> source <span class="token operator">=</span> walletEntries<span class="token punctuation">[</span>args<span class="token punctuation">.</span>source<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">// In a global network, you would simply pass in the target public key.</span>
    <span class="token comment">// But for testing purposes, we'll just use a local wallet entry</span>
    <span class="token keyword">const</span> target <span class="token operator">=</span> walletEntries<span class="token punctuation">[</span>args<span class="token punctuation">.</span>target<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">// Encrypt the message with your private key and the target public key</span>
    <span class="token keyword">const</span> text <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">encrypt</span><span class="token punctuation">(</span>
      args<span class="token punctuation">.</span>message<span class="token punctuation">,</span>
      crypto<span class="token punctuation">.</span><span class="token function">convertSkToCurve</span><span class="token punctuation">(</span>source<span class="token punctuation">.</span>keys<span class="token punctuation">.</span>secretKey<span class="token punctuation">)</span><span class="token punctuation">,</span>
      crypto<span class="token punctuation">.</span><span class="token function">convertPkToCurve</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>address<span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Get the toll required for sending a message to the target</span>
    <span class="token function">getToll</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>address<span class="token punctuation">,</span> args<span class="token punctuation">.</span>source<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">toll</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// Same thing as a normal &quot;message&quot; transaction</span>
      <span class="token keyword">const</span> tx <span class="token operator">=</span> <span class="token punctuation">{</span>
        type<span class="token operator">:</span> <span class="token string">&quot;message&quot;</span><span class="token punctuation">,</span>
        srcAcc<span class="token operator">:</span> source<span class="token punctuation">.</span>address<span class="token punctuation">,</span>
        tgtAcc<span class="token operator">:</span> target<span class="token punctuation">.</span>address<span class="token punctuation">,</span>
        message<span class="token operator">:</span> <span class="token punctuation">{</span>
          text<span class="token punctuation">,</span> <span class="token comment">// The encrypted message text</span>
          timestamp<span class="token operator">:</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        amount<span class="token operator">:</span> toll<span class="token punctuation">,</span>
        timestamp<span class="token operator">:</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token comment">// Sign the transaction with the source account</span>
      crypto<span class="token punctuation">.</span><span class="token function">signObj</span><span class="token punctuation">(</span>tx<span class="token punctuation">,</span> source<span class="token punctuation">.</span>keys<span class="token punctuation">.</span>secretKey<span class="token punctuation">,</span> source<span class="token punctuation">.</span>keys<span class="token punctuation">.</span>publicKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// Send the transaction to the network</span>
      <span class="token function">injectTx</span><span class="token punctuation">(</span>tx<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Now that we can send encrypted messages to other users in the network, we need a way for ourselves, and other users to decrypt those messages. After all, anytime we try to read an encrpyted message now, we see something like this... (Which is the text &quot;hi&quot;, encrypted)</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token property">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;[\&quot;1608d638cfc43df33347a5afb94f0e200ed7\&quot;,\&quot;8d125bc9156fce8afd2eca7a1901537a942cdec40bf6c429\&quot;]&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token number">1568063378906</span><span class="token punctuation">,</span>
    <span class="token property">&quot;handle&quot;</span><span class="token operator">:</span> <span class="token string">&quot;kyle&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre></div><blockquote><p>I decided to modify the &quot;poll message&quot; CLI command in order to parse &quot;encrypted&quot; messages alongside regular &quot;public&quot; messages. Since encrypted messages have a text property in the form of a stringified array, we need a way to differentiate them from the public messages that have text as a normal string property. I used a try catch block with JSON.parse to identify whether or not the text property was an object. If it is an object, decrypt it. If it isn't catch the exception of trying to parse a normal string and return the message without any modification.</p></blockquote> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// The Required Modules</span>
<span class="token keyword">const</span> vorpal <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;vorpal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> got <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;got&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;shardus-crypto-utils&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">crypto</span><span class="token punctuation">(</span><span class="token string">&quot;64f152869ca2d473e4ba64ab53f49ccdb2edae22da192c126850970e788af347&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">pollMessages</span><span class="token punctuation">(</span><span class="token parameter">source<span class="token punctuation">,</span> target<span class="token punctuation">,</span> timestamp</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">got</span><span class="token punctuation">(</span>
      <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">http://</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>host<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/messages/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>source<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>target<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>timestamp<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> messages <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> messages<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> err<span class="token punctuation">.</span>message<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

vorpal
  <span class="token punctuation">.</span><span class="token function">command</span><span class="token punctuation">(</span>
    <span class="token string">&quot;message poll &lt;source&gt; &lt;target&gt; &lt;timestamp&gt;&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;polls data for messages between &lt;source&gt; and &lt;target&gt; after specified timestamp&quot;</span>
  <span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">action</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">args<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> srcAcc <span class="token operator">=</span> walletEntries<span class="token punctuation">[</span>args<span class="token punctuation">.</span>source<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> tgtAcc <span class="token operator">=</span> walletEntries<span class="token punctuation">[</span>args<span class="token punctuation">.</span>target<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">pollMessages</span><span class="token punctuation">(</span>srcAcc<span class="token punctuation">.</span>address<span class="token punctuation">,</span> tgtAcc<span class="token punctuation">.</span>address<span class="token punctuation">,</span> args<span class="token punctuation">.</span>timestamp<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>
      <span class="token parameter">messages</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
          messages <span class="token operator">=</span> messages<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">message</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
              <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>message<span class="token punctuation">.</span>text<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                message<span class="token punctuation">.</span>text <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">decrypt</span><span class="token punctuation">(</span>
                  message<span class="token punctuation">.</span>text<span class="token punctuation">,</span>
                  crypto<span class="token punctuation">.</span><span class="token function">convertSkToCurve</span><span class="token punctuation">(</span>srcAcc<span class="token punctuation">.</span>keys<span class="token punctuation">.</span>secretKey<span class="token punctuation">)</span><span class="token punctuation">,</span>
                  crypto<span class="token punctuation">.</span><span class="token function">convertPkToCurve</span><span class="token punctuation">(</span>tgtAcc<span class="token punctuation">.</span>keys<span class="token punctuation">.</span>publicKey<span class="token punctuation">)</span>
                <span class="token punctuation">)</span><span class="token punctuation">.</span>message<span class="token punctuation">;</span>
                <span class="token keyword">return</span> message<span class="token punctuation">;</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token keyword">return</span> message<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>messages<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/source/main-concepts/building-a-poc-app/building-a-reward-system.html" class="prev">
        Building a reward system
      </a></span> <span class="next"><a href="/source/main-concepts/building-a-poc-app/building-a-frontend/building-a-frontend.html">
        Building a frontend
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.00bf7fce.js" defer></script><script src="/assets/js/2.3fd0cf3c.js" defer></script><script src="/assets/js/20.395bbe02.js" defer></script>
  </body>
</html>
